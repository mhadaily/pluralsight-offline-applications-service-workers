<div class="container">
  <!-- Header -->
  <section class="header mb-6">
    <div class="text-center mb-4">
      <h1>Streaming Demo</h1>
      <p class="text-secondary">
        Experience the power of streaming responses with Service Workers and the
        Streams API.
      </p>
    </div>
  </section>

  <!-- Stream Examples -->
  <section class="stream-examples mb-8">
    <h2 class="mb-4">Live Examples</h2>
    {{STREAM_EXAMPLES}}
  </section>

  <!-- How It Works -->
  <section class="how-it-works mb-8">
    <div class="card">
      <div class="card-header">
        <h3 class="card-title">How Streaming Works</h3>
      </div>
      <div class="card-content">
        <div class="grid grid-cols-2">
          <div>
            <h4 style="margin-bottom: 1rem">Traditional Loading</h4>
            <div class="timeline">
              <div class="timeline-item">
                <div
                  class="timeline-dot"
                  style="background: var(--error)"
                ></div>
                <div class="timeline-content">
                  <strong>Request sent</strong>
                  <p>Browser waits for complete response</p>
                </div>
              </div>
              <div class="timeline-item">
                <div
                  class="timeline-dot"
                  style="background: var(--warning)"
                ></div>
                <div class="timeline-content">
                  <strong>Server processing</strong>
                  <p>User sees blank page or spinner</p>
                </div>
              </div>
              <div class="timeline-item">
                <div
                  class="timeline-dot"
                  style="background: var(--success)"
                ></div>
                <div class="timeline-content">
                  <strong>Complete response</strong>
                  <p>Page renders all at once</p>
                </div>
              </div>
            </div>
          </div>

          <div>
            <h4 style="margin-bottom: 1rem">Streaming Responses</h4>
            <div class="timeline">
              <div class="timeline-item">
                <div
                  class="timeline-dot"
                  style="background: var(--success)"
                ></div>
                <div class="timeline-content">
                  <strong>Request sent</strong>
                  <p>Immediate response starts</p>
                </div>
              </div>
              <div class="timeline-item">
                <div
                  class="timeline-dot"
                  style="background: var(--success)"
                ></div>
                <div class="timeline-content">
                  <strong>Progressive rendering</strong>
                  <p>Content appears as it's ready</p>
                </div>
              </div>
              <div class="timeline-item">
                <div
                  class="timeline-dot"
                  style="background: var(--success)"
                ></div>
                <div class="timeline-content">
                  <strong>Continuous updates</strong>
                  <p>Better perceived performance</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Code Example -->
  <section class="code-example mb-8">
    <div class="card">
      <div class="card-header">
        <h3 class="card-title">Service Worker Implementation</h3>
      </div>
      <div class="card-content">
        <pre
          style="
            background: var(--bg-secondary);
            padding: 1rem;
            border-radius: var(--border-radius);
            overflow-x: auto;
            font-size: 0.875rem;
          "
        ><code>// Service Worker Streaming Example
self.addEventListener('fetch', (event) => {
  if (url.pathname === '/stream/html') {
    event.respondWith(new Response(new ReadableStream({
      start(controller) {
        const encoder = new TextEncoder();
        
        // Send header immediately
        controller.enqueue(encoder.encode('&lt;!DOCTYPE html&gt;'));
        controller.enqueue(encoder.encode('&lt;html&gt;&lt;body&gt;'));
        
        // Send content progressively
        controller.enqueue(encoder.encode('&lt;h1&gt;Streaming Page&lt;/h1&gt;'));
        
        setTimeout(() => {
          controller.enqueue(encoder.encode('&lt;p&gt;This loaded later...&lt;/p&gt;'));
          controller.close();
        }, 1000);
      }
    }), {
      headers: { 'Content-Type': 'text/html' }
    }));
  }
});</code></pre>
      </div>
    </div>
  </section>

  <!-- Performance Benefits -->
  <section class="benefits">
    <h2 class="mb-4">Performance Benefits</h2>
    <div class="grid grid-cols-3">
      <div class="card">
        <div class="card-content text-center">
          <div
            style="
              font-size: 2.5rem;
              margin-bottom: 1rem;
              color: var(--success);
            "
          >
            âš¡
          </div>
          <h4>Faster First Paint</h4>
          <p style="font-size: 0.875rem; color: var(--text-secondary)">
            Content starts rendering immediately, improving perceived
            performance.
          </p>
        </div>
      </div>

      <div class="card">
        <div class="card-content text-center">
          <div
            style="
              font-size: 2.5rem;
              margin-bottom: 1rem;
              color: var(--primary);
            "
          >
            ðŸ”„
          </div>
          <h4>Progressive Loading</h4>
          <p style="font-size: 0.875rem; color: var(--text-secondary)">
            Users can start interacting with content before it's fully loaded.
          </p>
        </div>
      </div>

      <div class="card">
        <div class="card-content text-center">
          <div
            style="font-size: 2.5rem; margin-bottom: 1rem; color: var(--accent)"
          >
            ðŸ’¾
          </div>
          <h4>Memory Efficient</h4>
          <p style="font-size: 0.875rem; color: var(--text-secondary)">
            Process data in chunks without loading everything into memory.
          </p>
        </div>
      </div>
    </div>
  </section>
</div>

<style>
  .timeline {
    position: relative;
    padding-left: 2rem;
  }

  .timeline::before {
    content: '';
    position: absolute;
    left: 0.75rem;
    top: 0;
    bottom: 0;
    width: 2px;
    background: var(--border-color);
  }

  .timeline-item {
    position: relative;
    margin-bottom: 1.5rem;
  }

  .timeline-dot {
    position: absolute;
    left: -2rem;
    top: 0.25rem;
    width: 12px;
    height: 12px;
    border-radius: 50%;
    border: 2px solid var(--bg-card);
  }

  .timeline-content strong {
    display: block;
    margin-bottom: 0.25rem;
    color: var(--text-primary);
  }

  .timeline-content p {
    margin: 0;
    font-size: 0.875rem;
    color: var(--text-secondary);
  }
</style>
