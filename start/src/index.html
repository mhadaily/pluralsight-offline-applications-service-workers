<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Travel Planner</title>
    <meta
      name="description"
      content="Plan your perfect trip with our offline-capable travel planner"
    />

    <meta name="theme-color" content="#2563eb" />

    <!-- Icons -->
    <link
      rel="icon"
      type="image/png"
      sizes="192x192"
      href="/icons/icon-192.png"
    />
    <link rel="apple-touch-icon" href="/icons/icon-192.png" />

    <!-- Styles -->
    <link rel="stylesheet" href="/styles.css" />
  </head>
  <body>
    <div id="app">
      <!-- Navigation -->
      <nav class="nav" role="navigation" aria-label="Main navigation">
        <div class="nav-container">
          <div class="nav-brand">
            <span class="nav-logo">‚úàÔ∏è</span>
            <span class="nav-title">Travel Planner</span>
          </div>
          <ul class="nav-menu" role="menubar">
            <li>
              <a href="#/" class="nav-link" data-route="home" role="menuitem"
                >Home</a
              >
            </li>
            <li>
              <a
                href="#/ideas"
                class="nav-link"
                data-route="ideas"
                role="menuitem"
                >Ideas</a
              >
            </li>
            <li>
              <a
                href="#/deals"
                class="nav-link"
                data-route="deals"
                role="menuitem"
                >Deals</a
              >
            </li>
            <li>
              <a
                href="#/streams"
                class="nav-link"
                data-route="streams"
                role="menuitem"
                >Streams</a
              >
            </li>
            <li>
              <a
                href="#/settings"
                class="nav-link"
                data-route="settings"
                role="menuitem"
                >Settings</a
              >
            </li>
            <li>
              <!-- Theme toggle (shown if JS decides theme is toggleable) -->
              <button
                id="theme-toggle"
                class="nav-link btn-icon"
                title="Toggle theme"
                aria-label="Toggle theme"
                type="button"
                style="border: none; background: transparent"
              >
                üåì
              </button>
            </li>
          </ul>
        </div>
      </nav>

      <!-- Main Content -->
      <main id="main-content" class="main-content" role="main">
        <!-- Dynamic content will be loaded here -->
      </main>

      <!-- Toast Notifications -->
      <div
        id="toast-container"
        class="toast-container"
        aria-live="polite"
        aria-atomic="true"
      ></div>

      <!-- Loading Spinner -->
      <div id="loading" class="loading hidden" aria-label="Loading">
        <div class="spinner"></div>
      </div>
      <!-- Update Banner -->
      <div id="update-banner" class="update-banner hidden" role="banner">
        <div class="update-content">
          <span class="update-text">üì¶ A new version is available!</span>
          <button id="update-btn" class="update-btn" type="button">
            Refresh
          </button>
          <button
            id="dismiss-update"
            class="dismiss-btn"
            type="button"
            aria-label="Dismiss update"
          >
            ‚úï
          </button>
        </div>
      </div>
    </div>

    <!-- Scripts -->
    <script>
      // Initialize theme from localStorage and apply to <html> via data-theme.
      (function () {
        try {
          const saved = localStorage.getItem('theme');
          if (saved === 'dark') {
            document.documentElement.setAttribute('data-theme', 'dark');
          } else if (saved === 'light') {
            document.documentElement.setAttribute('data-theme', 'light');
          }
          // If no saved theme, leave data-theme unset to follow system preference
        } catch (e) {
          // ignore
        }
      })();

      // Theme toggle functions
      function setTheme(theme) {
        try {
          if (theme === 'dark') {
            document.documentElement.setAttribute('data-theme', 'dark');
            localStorage.setItem('theme', 'dark');
          } else if (theme === 'light') {
            document.documentElement.setAttribute('data-theme', 'light');
            localStorage.setItem('theme', 'light');
          } else {
            document.documentElement.removeAttribute('data-theme');
            localStorage.removeItem('theme');
          }
        } catch (e) {
          // ignore storage errors
        }
      }

      function toggleTheme() {
        const isDark =
          document.documentElement.getAttribute('data-theme') === 'dark';
        setTheme(isDark ? 'light' : 'dark');

        // Show a visual confirmation - just update the browser console for now
        // The theme change itself should be immediately visible
        const message = isDark
          ? 'Switched to light theme'
          : 'Switched to dark theme';
      }

      // Setup theme toggle when DOM is ready
      document.addEventListener('DOMContentLoaded', function () {
        const themeToggle = document.getElementById('theme-toggle');
        if (themeToggle) {
          themeToggle.addEventListener('click', function (e) {
            e.preventDefault();
            toggleTheme();
          });
        }
      });
    </script>
    <script type="module" src="/app.js"></script>
  </body>
</html>
